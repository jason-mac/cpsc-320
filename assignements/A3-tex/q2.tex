\section{Fun with Recurrences}

Give an asymptotic solution (which should be a $\Theta$-bound) to each of the recurrences below. You may use whatever solution method you wish (drawing out the tree, unrolling the recurrence, proof by induction, Master Theorem, etc.), but make sure you fully justify your answer.

\begin{questions}
	\question[3] $T(n) = 2T(n-1) + 1$ for $n > 1$, $T(1) = 1$.

	\ifsolutions\input{q2a-sol.tex}\fi
	\begin{soln}
		\begin{align*}
			T(n) & = 2T(n-1) + 1                                    \\
			     & = 2(2T(n-2) + 1) + 1                             \\
			     & = 2^2T(n-2) + 2^1 + 2^0                          \\
			     & = 2^3T(n-3) + 2^2 + 2^1 + 2^0                    \\
			     & \dots                                            \\
			     & =2^{n-1}T(1) + 2^{n-2} + \dots + 2^2 + 2^1 + 2^0
		\end{align*}

		So my claim is, \(T(n) = \sum_{i = 0}^{n-1} 2^i = \frac{2^{n-1 + 1} - 1}{2 -1 } = 2^n - 1, n >1\).

		Proof: \(T(2) = 2T(1) + 1 = 3 = 2^2 - 1\). Base case holds. Then \(T(n+1) = 2T(n) + 1 = 2(2^n - 1) + 1 = 2^{n+1} - 1\). Thus, induction makes it hold.

		Then, \(\frac{2^{n}}{2} = 2^n - \frac{2^n}{2} \leq 2^n - 1 = T(n) \leq 2^n\). Hence, \(T(n) \in \Theta(2^n)\).
	\end{soln}

	\question[3] $T(n) = 3T\left( \frac{n}{2} \right) + e^n$ for $n > 1$, $T(1) = 1$.

	\ifsolutions\input{q2b-sol.tex}\fi
	\begin{soln}
		For the \(0\)th level of the tree, we are doing \(e^n\) amount of work then in the second we are getting, \(3e^{\frac{n}{2}}\).

		For any level of the tree we are going to be doing \(3^i e^\frac{n}{2^i}\) work. The height of the tree is \(\lg(n)\).

		Hence, \(T(n) = \sum_{i=0}^{\lg(n)} 3^i e^{\frac{n}{2^i}}\) for \(n > 1\). Then, if we consider \(\frac{T(n)}{e^n}\) we get:
		\[
			\frac{T(n)}{e^n} = \sum_{i=0}^{\lg(n)}3^i e^{n\left(\frac{1 - 2^i}{2^i}\right)} = 1 + 3e^{\frac{-n}{2}} + 3^2e^{\frac{-3n}{4}} + \dots + 3^{\lg(n)}e^{1-n}.
		\]

		Now, observe that if \(i \geq 1\) we get \(2^i \geq 2 \implies 1 - 2^i \leq -1 < 0\), since \(n > 1\) then \(1 - n < 0\).

		Hence, every term after \(i = 1\) has \(e^{-an}\) for some \(a > 0\) in other words, it decays exponentially.

		Then,
		\[
			\lim_{n \to \infty} \frac{T(n)}{e^n} = \lim_{n \to \infty} 1 + 3e^{\frac{-n}{2}} + 3^2e^{\frac{-3n}{4}} + \dots + 3^{\lg(n)}e^{1-n} = 1.
		\]

		Thus, \(T(n) \in \Theta (e^n)\).

	\end{soln}

	\question[3] $T(n) = T\left( \frac{n}{4} \right) + 2T\left( \frac{n}{16} \right) + \sqrt{n}$ for $n > 16$, $T(n) = 1$ for $n \le 16$.

	\ifsolutions\input{q2c-sol.tex}\fi
	\begin{soln}
		By drawing out the first three levels of the tree and its work needed to perform the subproblem, we see that:

		\begin{tikzpicture}[
				level 1/.style={sibling distance=55mm},
				level 2/.style={sibling distance=19mm},
				level 3/.style={sibling distance=10mm},
				edge from parent/.style={draw, -latex}
			]
			\node {\(n\) : \(\sqrt{n}\)}
			child {node {\(\frac{n}{4}\):\(\sqrt{\frac{n}{4}}\)}
					child {node {\(\frac{n}{16}\):\(\sqrt{\frac{n}{16}}\)}}
					child {node {\(\frac{n}{4}\):\(\sqrt{\frac{n}{64}}\)}}
					child {node {\(\frac{n}{4}\):\(\sqrt{\frac{n}{64}}\)}}
				}
			child {node {\(\frac{n}{16}\):\(\sqrt{\frac{n}{16}}\)}
					child {node {\(\frac{n}{64}\):\(\sqrt{\frac{n}{64}}\)}}
					child {node {\(\frac{n}{216}\):\(\sqrt{\frac{n}{216}}\)}}
					child {node {\(\frac{n}{216}\):\(\sqrt{\frac{n}{216}}\)}}
				}
			child {node {\(\frac{n}{16}\):\(\sqrt{\frac{n}{16}}\)}
					child {node {\(\frac{n}{64}\):\(\sqrt{\frac{n}{64}}\)}}
					child {node {\(\frac{n}{216}\):\(\sqrt{\frac{n}{216}}\)}}
					child {node {\(\frac{n}{216}\):\(\sqrt{\frac{n}{216}}\)}}
				};
		\end{tikzpicture}



		If the top is level \(0\), then we see at level \(1\) we are doing \(\sqrt{n} \cdot ( \frac{1}{2} + \frac{1}{4} + \frac{1}{4}) = \sqrt{n}\) amount of work.

		At level \(2\), we are again doing \(\sqrt{n} \cdot (\frac{1}{4} + \frac{1}{8} + \frac{1}{8} + \frac{1}{8} + \frac{1}{16} + \frac{1}{16} + \frac{1}{8} + \frac{1}{16} + \frac{1}{16}) = \sqrt{n}\) amount of work.

		Then for each level \(i\) we are doing \(\sqrt{n}\) amount of work, then we have that \(h = \log_{16}(n)\) is the amount of levels we have to work through.

		Thus, \(T(n) = \log_{16}(n) \cdot \sqrt{n} \in \Theta (\sqrt{n} \log(n))\).
	\end{soln}

	\question[3] $T(m,n) = mT(m, \frac{n}{3}) + n$ for $m \ge 1$ and $n \ge 3$; $T(m,n) = 1$ for $m \ge 1$ and $n < 3$.

	\ifsolutions\input{q2d-sol.tex}\fi

	\begin{soln}
		We consider cases on a fixed \(m\). Once \(m\) is chosen, it remains the same for every recursive call.

		We will show that each case corresponds to a certain case of the master thoerem, denote \(f(n) = n\).

		Case \(m > 3\), then \(\log_3(m) > 1\). Then set \(\varepsilon = \log_3(m) - 1 > 0\) so that \(\log_3(m) - \varepsilon = 1\).

		Thus, \(f(n) \in O(n^{\log_3(m) - \varepsilon})\). This corresponds to case \(1\) theorem, thus \(T(n) \in \Theta(n^{\log_3(m)})\).

		Case \(m = 3\). Then \(\log_3(m) = 1\). We see that \(f(n) = n \in \Theta(n^{\log_3(m)} \log^0(n))\).

		This corresponds to case 2 of the master theorem. Hence \(T(m, n) \in \Theta (n \log(n))\).

		Case \(m \leq 2\). Then \(0 < \log_3(m) < 1\), and hence we can set \(\varepsilon = 1 - \log_3(m) > 0\) so that \(\varepsilon + \log_3(m) = 1\).

		Then we see that \(n \in \Omega(n^{1+\varepsilon})\). Then observe that \(m < 3 \implies \frac{m}{3} < 1 \).

		Now, take any \(\delta\), with \(0 < \frac{m}{3} < \delta < 1\) so that \(m f(\frac{n}{3}) = \frac{mn}{3} < \delta n = \delta f(n)\).

		This corresonds to case \(3\) of the master theorem, thus \(T(m, n) \in \Theta (n)\).

	\end{soln}


\end{questions}
